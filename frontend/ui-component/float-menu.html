<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¯å½¢æ‰‡å½¢æ‚¬æµ®èœå•</title>
    <style>
        /* åŸºç¡€æ ·å¼ */
        body {
            margin: 0;
            padding: 0;
            background-color: #e0f7fa;
            height: 100vh;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }

        .circular-menu {
            position: fixed;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4dd0e1, #00acc1);
            box-shadow: 0 8px 16px rgba(0, 172, 193, 0.3);
            cursor: move;
            z-index: 1000;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        .circular-menu::before {
            content: 'â˜°';
            color: white;
            font-size: 24px;
            transition: transform 0.3s ease;
        }

        .circular-menu.expanded::before {
            transform: rotate(90deg);
        }

        /* æ‰‡å½¢èœå•é¡¹ */
        .menu-item {
            position: absolute;
            width: 120px;
            height: 120px;
            clip-path: polygon(
                50% 50%,
                100% 0%,
                100% 50%
            );
            background: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transform-origin: top left;
            transition: all 0.4s ease;
            font-size: 18px;
            color: #00acc1;
        }

        .menu-item.active {
            opacity: 1;
            pointer-events: auto;
        }

        /* å¸é™„å¼•å¯¼ç‚¹ */
        .edge-guide {
            position: fixed;
            width: 5px;
            height: 5px;
            background: #00acc1;
            opacity: 0.3;
            z-index: 999;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <!-- èœå•å®¹å™¨ -->
    <div class="circular-menu" id="circularMenu">
        <!-- èœå•é¡¹æ¨¡æ¿ -->
        <div class="menu-item" data-icon="ğŸ“„" data-angle="0"></div>
        <div class="menu-item" data-icon="ğŸ“·" data-angle="60"></div>
        <div class="menu-item" data-icon="ğŸµ" data-angle="120"></div>
        <div class="menu-item" data-icon="ğŸ“" data-angle="180"></div>
        <div class="menu-item" data-icon="ğŸŒ" data-angle="240"></div>
        <div class="menu-item" data-icon="âš™ï¸" data-angle="300"></div>
    </div>

    <!-- å¸é™„å¼•å¯¼ç‚¹ -->
    <div class="edge-guide" id="leftGuide" style="left: 0; top: 50%; transform: translateY(-50%);"></div>
    <div class="edge-guide" id="rightGuide" style="right: 0; top: 50%; transform: translateY(-50%);"></div>
    <div class="edge-guide" id="topGuide" style="left: 50%; top: 0; transform: translateX(-50%);"></div>
    <div class="edge-guide" id="bottomGuide" style="left: 50%; bottom: 0; transform: translateX(-50%);"></div>

    <script>
        // èœå•é…ç½®
        const menu = document.getElementById('circularMenu');
        const items = document.querySelectorAll('.menu-item');
        const edgeGuides = document.querySelectorAll('.edge-guide');
        const radius = 140; // èœå•é¡¹è·ç¦»ä¸­å¿ƒç‚¹çš„åŠå¾„
        let isDragging = false;
        let isExpanded = false;
        let offsetX, offsetY;
        let guideTimeout;
        let currentEdge = null;

        // åˆå§‹åŒ–èœå•é¡¹ä½ç½®
        function initMenuItems() {
            items.forEach((item, index) => {
                const angle = parseFloat(item.getAttribute('data-angle')) || (360 / items.length) * index;
                const rad = angle * Math.PI / 180;
                const x = radius * Math.cos(rad);
                const y = radius * Math.sin(rad);
                
                // è®¾ç½®å…ƒç´ ä½ç½®
                item.style.transform = `translate(${x}px, ${y}px) rotate(${angle}deg)`;
                
                // åˆ›å»ºclip-path
                const clipAngle = 60; // æ‰‡å½¢è§’åº¦
                const startRad = (angle - clipAngle/2) * Math.PI / 180;
                const endRad = (angle + clipAngle/2) * Math.PI / 180;
                
                const p1x = 50 + 50 * Math.cos(startRad);
                const p1y = 50 + 50 * Math.sin(startRad);
                const p2x = 50 + 50 * Math.cos(endRad);
                const p2y = 50 + 50 * Math.sin(endRad);
                
                item.style.clipPath = `polygon(50% 50%, ${p1x}% ${p1y}%, ${p2x}% ${p2y}%)`;
            });
        }

        // æ‹–åŠ¨åŠŸèƒ½
        menu.addEventListener('mousedown', (e) => {
            if (isExpanded) return; // å±•å¼€çŠ¶æ€ä¸‹ç¦æ­¢æ‹–åŠ¨
            isDragging = true;
            offsetX = e.clientX - menu.offsetLeft;
            offsetY = e.clientY - menu.offsetTop;
            document.body.style.cursor = 'grabbing';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            
            const x = e.clientX - offsetX;
            const y = e.clientY - offsetY;
            menu.style.left = `${x}px`;
            menu.style.top = `${y}px`;
            checkEdgeProximity(x, y);
        });

        document.addEventListener('mouseup', () => {
            if (!isDragging) return;
            isDragging = false;
            document.body.style.cursor = 'default';
            snapToEdge();
        });

        // å±•å¼€/æ”¶èµ·èœå•
        menu.addEventListener('click', (e) => {
            if (e.target.closest('.menu-item')) return; // ç‚¹å‡»èœå•é¡¹æ—¶ä¸è§¦å‘å±•å¼€/æ”¶èµ·
            
            isExpanded = !isExpanded;
            menu.classList.toggle('expanded', isExpanded);
            
            items.forEach((item, index) => {
                item.classList.toggle('active', isExpanded);
                if (isExpanded) {
                    item.style.transitionDelay = `${index * 0.05}s`;
                } else {
                    item.style.transitionDelay = `${(items.length - index - 1) * 0.05}s`;
                }
            });
        });

        // æ£€æµ‹è¾¹ç¼˜æ¥è¿‘åº¦
        function checkEdgeProximity(x, y) {
            const threshold = 100;
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;
            
            edgeGuides.forEach(guide => guide.style.display = 'none');
            
            // æ˜¾ç¤ºæœ€è¿‘çš„å¼•å¯¼ç‚¹
            if (x < threshold) {
                edgeGuides[0].style.display = 'block';
            } else if (x > windowWidth - threshold - menu.offsetWidth) {
                edgeGuides[1].style.display = 'block';
            }
            
            if (y < threshold) {
                edgeGuides[2].style.display = 'block';
            } else if (y > windowHeight - threshold - menu.offsetHeight) {
                edgeGuides[3].style.display = 'block';
            }
        }

        // å¸é™„åˆ°è¾¹ç¼˜
        function snapToEdge() {
            const x = parseInt(menu.style.left);
            const y = parseInt(menu.style.top);
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;
            
            let targetX = x;
            let targetY = y;
            
            // åˆ¤æ–­æœ€è¿‘çš„è¾¹ç¼˜
            const edges = [
                { side: 'left', distance: x },
                { side: 'right', distance: windowWidth - x - menu.offsetWidth },
                { side: 'top', distance: y },
                { side: 'bottom', distance: windowHeight - y - menu.offsetHeight }
            ];
            
            const closest = edges.reduce((a, b) => a.distance < b.distance ? a : b);
            
            // è®¾ç½®å¸é™„ä½ç½®
            switch(closest.side) {
                case 'left':
                    targetX = 0;
                    break;
                case 'right':
                    targetX = windowWidth - menu.offsetWidth;
                    break;
                case 'top':
                    targetY = 0;
                    break;
                case 'bottom':
                    targetY = windowHeight - menu.offsetHeight;
                    break;
            }
            
            // åº”ç”¨åŠ¨ç”»
            menu.style.transition = 'all 0.3s ease';
            menu.style.left = `${targetX}px`;
            menu.style.top = `${targetY}px`;
            
            // é‡ç½®è¿‡æ¸¡æ•ˆæœ
            setTimeout(() => {
                menu.style.transition = '';
            }, 300);
            
            currentEdge = closest.side;
        }

        // çª—å£å¤§å°å˜åŒ–æ—¶è°ƒæ•´ä½ç½®
        window.addEventListener('resize', () => {
            if (currentEdge) {
                const menuWidth = menu.offsetWidth;
                const menuHeight = menu.offsetHeight;
                const windowWidth = window.innerWidth;
                const windowHeight = window.innerHeight;
                
                switch(currentEdge) {
                    case 'left':
                        menu.style.left = '0';
                        break;
                    case 'right':
                        menu.style.left = `${windowWidth - menuWidth}px`;
                        break;
                    case 'top':
                        menu.style.top = '0';
                        break;
                    case 'bottom':
                        menu.style.top = `${windowHeight - menuHeight}px`;
                        break;
                }
            }
        });

        // åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', () => {
            initMenuItems();
        });
    </script>
</body>
</html>